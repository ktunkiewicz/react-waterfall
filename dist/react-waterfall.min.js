"use strict";function _interopDefault(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var React=require("react"),React__default=_interopDefault(React);function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _extends(){return(_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){_defineProperty(t,e,r[e])})}return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");_setPrototypeOf(t.prototype,e&&e.prototype),e&&_setPrototypeOf(t,e)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.getPrototypeOf||function(t){return t.__proto__})(t)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _objectWithoutProperties(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||(o[r]=t[r]);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var EnhancedProvider=function(t,e,r,n,o){return function(i){function a(e){var n;_classCallCheck(this,a),_defineProperty(_assertThisInitialized(_assertThisInitialized(n=_possibleConstructorReturn(this,_getPrototypeOf(a).call(this)))),"internalState",{}),_defineProperty(_assertThisInitialized(_assertThisInitialized(n)),"initializedMiddlewares",[]),n.state=e.initialState||r.initialState,n.setInternalState(n.state);var i=e.actionsCreators||r.actionsCreators;return n.state.reactWaterfallActions=n.buildActions(i),n.initializedMiddlewares=o.map(function(t){return t({initialState:n.getInternalState(),actionsCreators:i},_assertThisInitialized(_assertThisInitialized(n)),n.getActions())}),t(_assertThisInitialized(_assertThisInitialized(n))),n}return _createClass(a,[{key:"getInternalState",value:function(){return this.internalState}},{key:"setInternalState",value:function(t){this.internalState=t}},{key:"getActions",value:function(){return this.state.reactWaterfallActions}},{key:"buildActions",value:function(t){var e=this;return Object.keys(t).reduce(function(r,n){return _objectSpread({},r,_defineProperty({},n,function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];var a=t[n].apply(t,[e.getInternalState(),e.getActions()].concat(o));return e.handleActionResult.apply(e,[n,a].concat(o))}))},{})}},{key:"handleActionResult",value:function(t,e){for(var r=this,n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];return e&&"object"===_typeof(e)?e.then?(e.then&&e.then(function(e){return r.handleActionResult.apply(r,[t,e].concat(o))}),e):(this.updateState.apply(this,[t,e].concat(o)),Promise.resolve(e)):Promise.resolve(e)}},{key:"updateState",value:function(t,e){for(var r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];var a=_objectSpread({},this.state,e);n.getSubscriptions().forEach(function(r){return r.apply(void 0,[t,e].concat(o))}),this.setInternalState(a),this.initializedMiddlewares.forEach(function(e){return e.apply(void 0,[t,a].concat(o))}),this.setState(a)}},{key:"render",value:function(){return React__default.createElement(e,{value:this.state},this.props.children)}}]),_inherits(a,i),a}(React.Component)},Prevent=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).apply(this,arguments))}return _createClass(e,[{key:"render",value:function(){var t=this.props;return(0,t.renderComponent)(_objectWithoutProperties(t,["renderComponent"]))}}]),_inherits(e,t),e}(React.PureComponent),connect=function(t){return function(e){return function(r){var n=function(t){return React.createElement(r,t)},o=function(o){return React.createElement(t,null,function(t){if(t&&t.reactWaterfallActions){var i=t.reactWaterfallActions,a=_objectWithoutProperties(t,["reactWaterfallActions"]),s=e(a||{},i);return React.createElement(Prevent,_extends({renderComponent:n},o,s))}var c=r.prototype&&r.prototype.constructor&&r.prototype.constructor.name||null,u="string"==typeof c?" (".concat(c,")"):"";console.error("Connected component".concat(u," must be wrapped with ","<Provider />"))})};return o.displayName="Connect(".concat(r.displayName||r.name||"Unknown",")"),o}}},Subscriptions=function t(){var e=this;_classCallCheck(this,t),_defineProperty(this,"subscriptions",[]),_defineProperty(this,"getSubscriptions",function(){return e.subscriptions}),_defineProperty(this,"subscribe",function(t){e.subscriptions=_toConsumableArray(e.subscriptions).concat([t])}),_defineProperty(this,"unsubscribe",function(t){e.subscriptions=e.subscriptions.filter(function(e){return e!==t})})},defaultMiddlewares=[],Store=function(){function t(){var e=this;_classCallCheck(this,t),_defineProperty(this,"subscriptions",new Subscriptions),_defineProperty(this,"provider",null),_defineProperty(this,"setProvider",function(t){e.provider=t})}return _createClass(t,[{key:"create",value:function(t,e){var r=React.createContext();return{Provider:EnhancedProvider(this.setProvider,r.Provider,t,this.subscriptions,_toConsumableArray(e).concat(defaultMiddlewares)),connect:connect(r.Consumer,this),subscribe:this.subscriptions.subscribe,unsubscribe:this.subscriptions.unsubscribe}}}]),t}(),createStore=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(new Store).create(t,e)};module.exports=createStore;
//# sourceMappingURL=react-waterfall.min.js.map
